pipeline {
 agent any

 environment{
    nodeJSInstallationName = 'node21.1.0'
 }

 stages {
    stage('Clonar repositorio') {
        steps {
            git 'https://github.com/rafperdevops/hotel.git'
        }
    }
    stage('Instalar dependencias') {        
        steps {
            script {
                withNodeJS(env.nodeJSInstallationName) {
                    sh 'npm install'
                }
            }
        }
    }
    stage('Realizar pruebas') {
        steps {
            script {
                withNodeJS(env.nodeJSInstallationName) {
                    sh 'npm test'
                }
            }
        }
    }
    // stage('Inicias app') {
    //     steps {
    //         script {
    //             withNodeJS(env.nodeJSInstallationName) {
    //                 sh 'node app.js'
    //             }
    //         }
    //     }
    // }
    post {
        always {
            // Acciones que se ejecutarán siempre, independientemente del resultado del pipeline
            deleteDir() // Borra los archivos residuales de la ejecución del job
        }
        
        success {
            // Acciones que se ejecutarán solo si el pipeline tiene éxito
            echo 'El pipeline se ejecutó exitosamente'
        }
        
        failure {
            // Acciones que se ejecutarán solo si el pipeline falla
            echo 'El pipeline falló'
        }
    }
 }
}
